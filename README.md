# 盖洛普优势识别器（HTML版）

本页实现：
- 题目渲染（从文件导入）
- 根据映射累加计分与排序
- 展示 TOP5 与 34 项完整排序与描述

文件：`index.html`（双击浏览器打开）

## 数据导入
支持三种格式：

1) JSON（推荐）
```json
{
  "questions": [
    {
      "text": "你更喜欢独立完成任务还是与他人合作？",
      "options": [
        { "text": "独立完成", "scores": { "追求": 2, "自信": 1 } },
        { "text": "与他人合作", "scores": { "交往": 2, "包容": 1 } }
      ]
    }
  ]
}
```

2) CSV/TSV（简易约定）
- 一行一题。
- 列1=题干；后续各列=“选项文本|优势:权重;优势:权重”。
- 示例：
```
你更喜欢？, 独立完成|追求:2;自信:1, 与他人合作|交往:2;包容:1
```

3) Excel（.xlsx/.xls）
- 默认读取名为“测试题”的工作表（sheet）。若没有该名称，将读取第一个sheet。
- 支持两类常见结构：
  - 宽表：每行一题；列1=题干；后续成对列=选项文本、映射。
    示例（列）：题干 | 选项A | 映射A | 选项B | 映射B | ...
    其中“映射”内容格式为：优势:权重;优势:权重（如：追求:2;自信:1）
  - 长表：每行一个选项；需要包含列：题号/题干、选项文本、映射。
    程序会按题号或题干聚合成一题。

> 注意：计分逻辑完全按映射累加。要与Excel结果完全一致，请确保导入数据的分配规则与Excel一致。

## 使用步骤
1. 打开 `index.html`。
2. 点击“导入题库与计分映射”，选择你的 JSON/CSV/Excel 文件（Excel默认取“测试题”sheet）。
3. 页面自动生成题目；作答后点击“提交”查看结果。

## 下一步（如需我全程接入Excel）
- 将包含题库与公式的原始 Excel（.xlsx/.xls）放到工作区，并告知我文件路径及表/列的规则。
- 我将编写一次性转换脚本（.py 或 .js）把Excel题库与映射导出为 JSON，写入到 `gallup-web` 并接线到 `index.html`。
- 若Excel内有加权/归一/逆向/分组加总等公式，我会按等价JS实现，保证计算一致。
